<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grid Toggle — Matplotlib Match</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; margin: 24px; }
    .cell { stroke: seagreen; stroke-width: 2; cursor: pointer; }
    #wrap { display:inline-block; border:1px solid #eee; padding:12px; border-radius:12px; }
  </style>
</head>
<body>
  <h1 style="font-size:18px;margin:0 0 12px;">交互网格（严格匹配 Matplotlib 布局）</h1>
  <div id="wrap">
    <!-- viewBox 与 xlim/ylim 完全一致：x: [-0.5, 7.5] 宽=8；y: [-0.5, 6.5] 高=7 -->
    <svg id="grid" width="480" height="420" viewBox="-0.5 -0.5 8 7" preserveAspectRatio="xMidYMid meet"></svg>
  </div>

  <script>
    // 与原脚本一致的行配置；若你想要 4,5,6,6,5,4，只需改这里：
    const rowCounts = [3, 5, 7, 7, 5, 3];
    const cellSize  = 1.0;
    const maxCount  = Math.max(...rowCounts);
    const rows      = rowCounts.length;

    const svg = document.getElementById('grid');

    // 状态：true=绿，false=红
    const state = {};
    const keyOf = (r,c) => `${r}-${c}`;

    for (let r = 0; r < rows; r++) {
      const cnt = rowCounts[r];
      const xOffset = (maxCount - cnt) / 2.0;
      const y = (rows - 1 - r); // 顶部 y 更大（与 Matplotlib 代码一致）
      for (let c = 0; c < cnt; c++) {
        const x = xOffset + c;

        const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        rect.setAttribute("x", x);
        rect.setAttribute("y", y);
        rect.setAttribute("width", cellSize);
        rect.setAttribute("height", cellSize);

        // 颜色/透明度与线宽严格匹配
        rect.setAttribute("fill", "lightgreen");
        rect.setAttribute("fill-opacity", "0.7");
        rect.classList.add("cell");

        const k = keyOf(r,c);
        state[k] = true;

        rect.addEventListener("click", () => {
          if (state[k]) {
            rect.setAttribute("fill", "red");
            rect.setAttribute("fill-opacity", "1.0"); // Matplotlib 红色默认不透明
            state[k] = false;
          } else {
            rect.setAttribute("fill", "lightgreen");
            rect.setAttribute("fill-opacity", "0.7");
            state[k] = true;
          }
        });

        svg.appendChild(rect);
      }
    }
  </script>
</body>
</html>
